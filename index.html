<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Data Filters for Truck Dataset</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="script.js" defer></script>
</head>
<body>
    <div class="container">
        <div class="filters">
            <h2>Filtri</h2>
            <label for="fileUpload">Carica il file:</label>
            <input type="file" id="fileUpload" accept=".xlsx">
            <div class="filter-grid">
                <div>
                    <label for="causa">Causa:</label>
                    <select id="causa"></select>
                </div>
                <div>
                    <label for="marca">Marca:</label>
                    <select id="marca" multiple></select>
                </div>
                <div>
                    <label for="prezzo">Prezzo:</label>
                    <select id="prezzo"></select>
                </div>
                <div>
                    <label for="condizione">Condizione:</label>
                    <select id="condizione" multiple></select>
                </div>
                <div>
                    <label for="acquisto">Tipologia Acquisto:</label>
                    <select id="acquisto" multiple></select>
                </div>
                <div>
                    <label for="statoAttuale">Stato Attuale dei Camion:</label>
                    <select id="statoAttuale" multiple></select>
                </div>
                <div>
                    <label for="dataFineRivalutazione">Data Fine Rivalutazione:</label>
                    <input type="date" id="dataFineRivalutazione" value="2024-07-31" onchange="expandTable()">
                </div>
                <div>
                    <label for="periodoLingering">Periodo Lingering (Anni):</label>
                    <select id="periodoLingering">
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3" selected>3</option>
                    </select>
                </div>
            </div>
            <div class="stats">
                <div class="stat">
                    <h3>Fatturato</h3>
                    <div id="fatturato">€0,00</div>
                    <div class="input-with-symbol">
                        <input type="number" id="sovrapprezzoCartello" placeholder="Sovrapprezzo Periodo Cartello" value="32.6" onchange="ProcessData()">
                        <span>%</span>
                    </div>
                    <div class="input-with-symbol">
                        <input type="number" id="sovrapprezzoLingering" placeholder="Sovrapprezzo Periodo Lingering" value="17.6" onchange="ProcessData()">
                        <span>%</span>
                    </div>
                </div>
                <div class="stat">
                    <h3>Conteggio dei Camion</h3>
                    <div id="conteggio">0</div>
                    <div id="dannoCartello">Danno Sovrapprezzo (Periodo Cartello): €0,00</div>
                    <div id="dannoLingering">Danno Sovrapprezzo (Periodo Lingering): €0,00</div>
                </div>
            </div>
            <div class="danno-totale">
                <div id="dannoTotale">Danno Sovrapprezzo Totale: €0,00</div>
            </div>
            <div class="stats">
                <div class="stat">
                    <h3>Interessi</h3>
                    <div id="interessiLegaliTotale">Interessi Legali Totale: €0,00</div>
                    <div id="interessiLegaliWACCTotale">Interessi Legali WACC Totale: €0,00</div>
                </div>
                <div class="stat">
                    <h3>Danno Rivalutato</h3>
                    <div id="dannoRivalutatoTotale">Danno Rivalutato Totale: €0,00</div>
                    <div id="dannoRivalutatoWACCTotale">Danno Rivalutato WACC Totale: €0,00</div>
                </div>
            </div>
        </div>
        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr id="tableHeader"></tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
            <div class="pagination">
                <button id="prevPage" disabled>Previous</button>
                <span>Page <input type="number" id="pageInput" min="1" value="1" onchange="goToPage()"> of <span id="totalPages">1</span></span>
                <button id="nextPage" disabled>Next</button>
            </div>
            <div class="export-container">
                <button id="exportButton" onclick="exportTableToExcel()">Export to Excel</button>
            </div>
        </div>
    </div>
</body>
</html>